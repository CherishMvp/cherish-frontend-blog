import{_ as i,c as a,a2 as B,o as n}from"./chunks/framework.BeuUUHFt.js";const F=JSON.parse('{"title":"","description":"","frontmatter":{},"headers":[],"relativePath":"Python-100-Days/番外篇/常见反爬策略及应对方案.md","filePath":"Python-100-Days/番外篇/常见反爬策略及应对方案.md","lastUpdated":1731997977000}'),l={name:"Python-100-Days/番外篇/常见反爬策略及应对方案.md"};function h(p,s,k,t,e,r){return n(),a("div",null,s[0]||(s[0]=[B(`<h2 id="常见反爬策略及应对方案" tabindex="-1">常见反爬策略及应对方案 <a class="header-anchor" href="#常见反爬策略及应对方案" aria-label="Permalink to &quot;常见反爬策略及应对方案&quot;">​</a></h2><ol><li><p>构造合理的HTTP请求头。</p><ul><li><p>Accept</p></li><li><p>User-Agent</p></li><li><p>Referer</p></li><li><p>Accept-Encoding</p></li><li><p>Accept-Language</p></li></ul></li><li><p>检查网站生成的Cookie。</p><ul><li>有用的插件：<a href="http://www.editthiscookie.com/" target="_blank" rel="noreferrer">EditThisCookie</a></li><li>如何处理脚本动态生成的Cookie</li></ul></li><li><p>抓取动态内容。</p><ul><li>Selenium + WebDriver</li><li>Chrome / Firefox - Driver</li></ul></li><li><p>限制爬取的速度。</p></li><li><p>处理表单中的隐藏域。</p><ul><li>在读取到隐藏域之前不要提交表单</li><li>用RoboBrowser这样的工具辅助提交表单</li></ul></li><li><p>处理表单中的验证码。</p><ul><li><p>OCR（Tesseract） - 商业项目一般不考虑</p></li><li><p>专业识别平台 - 超级鹰 / 云打码</p><div class="language-Python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">Python</span><pre class="shiki shiki-themes min-dark one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#F97583;--shiki-dark:#C678DD;">from</span><span style="--shiki-light:#B392F0;--shiki-dark:#ABB2BF;"> hashlib </span><span style="--shiki-light:#F97583;--shiki-dark:#C678DD;">import</span><span style="--shiki-light:#B392F0;--shiki-dark:#ABB2BF;"> md5</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#F97583;--shiki-dark:#C678DD;">class</span><span style="--shiki-light:#B392F0;--shiki-dark:#E5C07B;"> ChaoClient</span><span style="--shiki-light:#B392F0;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#79B8FF;--shiki-dark:#56B6C2;">object</span><span style="--shiki-light:#B392F0;--shiki-dark:#ABB2BF;">):</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#F97583;--shiki-dark:#C678DD;">    def</span><span style="--shiki-light:#B392F0;--shiki-dark:#56B6C2;"> __init__</span><span style="--shiki-light:#B392F0;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#FF9800;--shiki-light-font-style:inherit;--shiki-dark:#E5C07B;--shiki-dark-font-style:italic;">self</span><span style="--shiki-light:#BBBBBB;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#FF9800;--shiki-light-font-style:inherit;--shiki-dark:#D19A66;--shiki-dark-font-style:italic;"> username</span><span style="--shiki-light:#BBBBBB;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#FF9800;--shiki-light-font-style:inherit;--shiki-dark:#D19A66;--shiki-dark-font-style:italic;"> password</span><span style="--shiki-light:#BBBBBB;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#FF9800;--shiki-light-font-style:inherit;--shiki-dark:#D19A66;--shiki-dark-font-style:italic;"> soft_id</span><span style="--shiki-light:#B392F0;--shiki-dark:#ABB2BF;">):</span></span>
<span class="line"><span style="--shiki-light:#B392F0;--shiki-dark:#E5C07B;">        self</span><span style="--shiki-light:#BBBBBB;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#B392F0;--shiki-dark:#ABB2BF;">username </span><span style="--shiki-light:#F97583;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#B392F0;--shiki-dark:#ABB2BF;"> username</span></span>
<span class="line"><span style="--shiki-light:#B392F0;--shiki-dark:#ABB2BF;">        password </span><span style="--shiki-light:#F97583;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#B392F0;--shiki-dark:#ABB2BF;">  password</span><span style="--shiki-light:#BBBBBB;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#B392F0;--shiki-dark:#61AFEF;">encode</span><span style="--shiki-light:#BBBBBB;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#FFAB70;--shiki-dark:#98C379;">&#39;utf-8&#39;</span><span style="--shiki-light:#BBBBBB;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#B392F0;--shiki-dark:#E5C07B;">        self</span><span style="--shiki-light:#BBBBBB;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#B392F0;--shiki-dark:#ABB2BF;">password </span><span style="--shiki-light:#F97583;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#B392F0;--shiki-dark:#61AFEF;"> md5</span><span style="--shiki-light:#BBBBBB;--shiki-dark:#ABB2BF;">(password).</span><span style="--shiki-light:#B392F0;--shiki-dark:#61AFEF;">hexdigest</span><span style="--shiki-light:#BBBBBB;--shiki-dark:#ABB2BF;">()</span></span>
<span class="line"><span style="--shiki-light:#B392F0;--shiki-dark:#E5C07B;">        self</span><span style="--shiki-light:#BBBBBB;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#B392F0;--shiki-dark:#ABB2BF;">soft_id </span><span style="--shiki-light:#F97583;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#B392F0;--shiki-dark:#ABB2BF;"> soft_id</span></span>
<span class="line"><span style="--shiki-light:#B392F0;--shiki-dark:#E5C07B;">        self</span><span style="--shiki-light:#BBBBBB;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#B392F0;--shiki-dark:#ABB2BF;">base_params </span><span style="--shiki-light:#F97583;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#BBBBBB;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#FFAB70;--shiki-dark:#98C379;">            &#39;user&#39;</span><span style="--shiki-light:#BBBBBB;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#B392F0;--shiki-dark:#E5C07B;"> self</span><span style="--shiki-light:#BBBBBB;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#B392F0;--shiki-dark:#ABB2BF;">username</span><span style="--shiki-light:#BBBBBB;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#FFAB70;--shiki-dark:#98C379;">            &#39;pass2&#39;</span><span style="--shiki-light:#BBBBBB;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#B392F0;--shiki-dark:#E5C07B;"> self</span><span style="--shiki-light:#BBBBBB;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#B392F0;--shiki-dark:#ABB2BF;">password</span><span style="--shiki-light:#BBBBBB;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#FFAB70;--shiki-dark:#98C379;">            &#39;softid&#39;</span><span style="--shiki-light:#BBBBBB;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#B392F0;--shiki-dark:#E5C07B;"> self</span><span style="--shiki-light:#BBBBBB;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#B392F0;--shiki-dark:#ABB2BF;">soft_id</span><span style="--shiki-light:#BBBBBB;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#BBBBBB;--shiki-dark:#ABB2BF;">        }</span></span>
<span class="line"><span style="--shiki-light:#B392F0;--shiki-dark:#E5C07B;">        self</span><span style="--shiki-light:#BBBBBB;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#B392F0;--shiki-dark:#ABB2BF;">headers </span><span style="--shiki-light:#F97583;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#BBBBBB;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#FFAB70;--shiki-dark:#98C379;">            &#39;Connection&#39;</span><span style="--shiki-light:#BBBBBB;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#FFAB70;--shiki-dark:#98C379;"> &#39;Keep-Alive&#39;</span><span style="--shiki-light:#BBBBBB;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#FFAB70;--shiki-dark:#98C379;">            &#39;User-Agent&#39;</span><span style="--shiki-light:#BBBBBB;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#FFAB70;--shiki-dark:#98C379;"> &#39;Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; Trident/4.0)&#39;</span><span style="--shiki-light:#BBBBBB;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#BBBBBB;--shiki-dark:#ABB2BF;">        }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#F97583;--shiki-dark:#C678DD;">    def</span><span style="--shiki-light:#B392F0;--shiki-dark:#61AFEF;"> post_pic</span><span style="--shiki-light:#B392F0;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#FF9800;--shiki-light-font-style:inherit;--shiki-dark:#E5C07B;--shiki-dark-font-style:italic;">self</span><span style="--shiki-light:#BBBBBB;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#FF9800;--shiki-light-font-style:inherit;--shiki-dark:#D19A66;--shiki-dark-font-style:italic;"> im</span><span style="--shiki-light:#BBBBBB;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#FF9800;--shiki-light-font-style:inherit;--shiki-dark:#D19A66;--shiki-dark-font-style:italic;"> codetype</span><span style="--shiki-light:#B392F0;--shiki-dark:#ABB2BF;">):</span></span>
<span class="line"><span style="--shiki-light:#B392F0;--shiki-dark:#ABB2BF;">        params </span><span style="--shiki-light:#F97583;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#BBBBBB;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#FFAB70;--shiki-dark:#98C379;">            &#39;codetype&#39;</span><span style="--shiki-light:#BBBBBB;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#B392F0;--shiki-dark:#ABB2BF;"> codetype</span><span style="--shiki-light:#BBBBBB;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#BBBBBB;--shiki-dark:#ABB2BF;">        }</span></span>
<span class="line"><span style="--shiki-light:#B392F0;--shiki-dark:#ABB2BF;">        params</span><span style="--shiki-light:#BBBBBB;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#B392F0;--shiki-dark:#61AFEF;">update</span><span style="--shiki-light:#BBBBBB;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#BBBBBB;--shiki-dark:#E5C07B;">self</span><span style="--shiki-light:#BBBBBB;--shiki-dark:#ABB2BF;">.base_params)</span></span>
<span class="line"><span style="--shiki-light:#B392F0;--shiki-dark:#ABB2BF;">        files </span><span style="--shiki-light:#F97583;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#BBBBBB;--shiki-dark:#ABB2BF;"> {</span><span style="--shiki-light:#FFAB70;--shiki-dark:#98C379;">&#39;userfile&#39;</span><span style="--shiki-light:#BBBBBB;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#B392F0;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#FFAB70;--shiki-dark:#98C379;">&#39;captcha.jpg&#39;</span><span style="--shiki-light:#BBBBBB;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#B392F0;--shiki-dark:#ABB2BF;"> im)</span><span style="--shiki-light:#BBBBBB;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"><span style="--shiki-light:#B392F0;--shiki-dark:#ABB2BF;">        r </span><span style="--shiki-light:#F97583;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#B392F0;--shiki-dark:#ABB2BF;"> requests</span><span style="--shiki-light:#BBBBBB;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#B392F0;--shiki-dark:#61AFEF;">post</span><span style="--shiki-light:#BBBBBB;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#FFAB70;--shiki-dark:#98C379;">&#39;http://upload.chaojiying.net/Upload/Processing.php&#39;</span><span style="--shiki-light:#BBBBBB;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#BBBBBB;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">data</span><span style="--shiki-light:#F97583;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#BBBBBB;--shiki-dark:#ABB2BF;">params, </span><span style="--shiki-light:#BBBBBB;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">files</span><span style="--shiki-light:#F97583;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#BBBBBB;--shiki-dark:#ABB2BF;">files, </span><span style="--shiki-light:#BBBBBB;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">headers</span><span style="--shiki-light:#F97583;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#BBBBBB;--shiki-dark:#E5C07B;">self</span><span style="--shiki-light:#BBBBBB;--shiki-dark:#ABB2BF;">.headers)</span></span>
<span class="line"><span style="--shiki-light:#F97583;--shiki-dark:#C678DD;">        return</span><span style="--shiki-light:#B392F0;--shiki-dark:#ABB2BF;"> r</span><span style="--shiki-light:#BBBBBB;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#B392F0;--shiki-dark:#61AFEF;">json</span><span style="--shiki-light:#BBBBBB;--shiki-dark:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#F97583;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#79B8FF;--shiki-dark:#E06C75;"> __name__</span><span style="--shiki-light:#F97583;--shiki-dark:#56B6C2;"> ==</span><span style="--shiki-light:#FFAB70;--shiki-dark:#98C379;"> &#39;__main__&#39;</span><span style="--shiki-light:#BBBBBB;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#B392F0;--shiki-dark:#ABB2BF;">    client </span><span style="--shiki-light:#F97583;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#B392F0;--shiki-dark:#61AFEF;"> ChaoClient</span><span style="--shiki-light:#BBBBBB;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#FFAB70;--shiki-dark:#98C379;">&#39;用户名&#39;</span><span style="--shiki-light:#BBBBBB;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#FFAB70;--shiki-dark:#98C379;">&#39;密码&#39;</span><span style="--shiki-light:#BBBBBB;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#FFAB70;--shiki-dark:#98C379;">&#39;软件ID&#39;</span><span style="--shiki-light:#BBBBBB;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#F97583;--shiki-dark:#C678DD;">    with</span><span style="--shiki-light:#B392F0;--shiki-dark:#56B6C2;"> open</span><span style="--shiki-light:#BBBBBB;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#FFAB70;--shiki-dark:#98C379;">&#39;captcha.jpg&#39;</span><span style="--shiki-light:#BBBBBB;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#FFAB70;--shiki-dark:#98C379;">&#39;rb&#39;</span><span style="--shiki-light:#BBBBBB;--shiki-dark:#ABB2BF;">)</span><span style="--shiki-light:#F97583;--shiki-dark:#C678DD;"> as</span><span style="--shiki-light:#B392F0;--shiki-dark:#E06C75;"> file</span><span style="--shiki-light:#BBBBBB;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#B392F0;--shiki-dark:#ABB2BF;">                                                </span></span>
<span class="line"><span style="--shiki-light:#B392F0;--shiki-dark:#56B6C2;">        print</span><span style="--shiki-light:#BBBBBB;--shiki-dark:#ABB2BF;">(client.</span><span style="--shiki-light:#B392F0;--shiki-dark:#61AFEF;">post_pic</span><span style="--shiki-light:#BBBBBB;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#BBBBBB;--shiki-dark:#E06C75;">file</span><span style="--shiki-light:#BBBBBB;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#F8F8F8;--shiki-dark:#D19A66;">1902</span><span style="--shiki-light:#BBBBBB;--shiki-dark:#ABB2BF;">))</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br></div></div></li></ul></li><li><p>绕开“陷阱”。</p><ul><li>网页上有诱使爬虫爬取的爬取的隐藏链接（陷阱或蜜罐）</li><li>通过Selenium+WebDriver+Chrome判断链接是否可见或在可视区域</li></ul></li><li><p>隐藏身份。</p><ul><li><p>代理服务 - 快代理 / 讯代理 / 芝麻代理 / 蘑菇代理 / 云代理</p><p><a href="https://cuiqingcai.com/5094.html" target="_blank" rel="noreferrer">《爬虫代理哪家强？十大付费代理详细对比评测出炉！》</a></p></li><li><p>洋葱路由 - 国内需要翻墙才能使用</p><div class="language-Shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">Shell</span><pre class="shiki shiki-themes min-dark one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#B392F0;--shiki-dark:#61AFEF;">yum</span><span style="--shiki-light:#9DB1C5;--shiki-dark:#D19A66;"> -y</span><span style="--shiki-light:#9DB1C5;--shiki-dark:#98C379;"> install</span><span style="--shiki-light:#9DB1C5;--shiki-dark:#98C379;"> tor</span></span>
<span class="line"><span style="--shiki-light:#B392F0;--shiki-dark:#61AFEF;">useradd</span><span style="--shiki-light:#9DB1C5;--shiki-dark:#98C379;"> admin</span><span style="--shiki-light:#9DB1C5;--shiki-dark:#D19A66;"> -d</span><span style="--shiki-light:#9DB1C5;--shiki-dark:#98C379;"> /home/admin</span></span>
<span class="line"><span style="--shiki-light:#B392F0;--shiki-dark:#61AFEF;">passwd</span><span style="--shiki-light:#9DB1C5;--shiki-dark:#98C379;"> admin</span></span>
<span class="line"><span style="--shiki-light:#B392F0;--shiki-dark:#61AFEF;">chown</span><span style="--shiki-light:#9DB1C5;--shiki-dark:#D19A66;"> -R</span><span style="--shiki-light:#9DB1C5;--shiki-dark:#98C379;"> admin:admin</span><span style="--shiki-light:#9DB1C5;--shiki-dark:#98C379;"> /home/admin</span></span>
<span class="line"><span style="--shiki-light:#B392F0;--shiki-dark:#61AFEF;">chown</span><span style="--shiki-light:#9DB1C5;--shiki-dark:#D19A66;"> -R</span><span style="--shiki-light:#9DB1C5;--shiki-dark:#98C379;"> admin:admin</span><span style="--shiki-light:#9DB1C5;--shiki-dark:#98C379;"> /var/run/tor</span></span>
<span class="line"><span style="--shiki-light:#B392F0;--shiki-dark:#61AFEF;">tor</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div></li></ul></li></ol>`,2)]))}const y=i(l,[["render",h]]);export{F as __pageData,y as default};
